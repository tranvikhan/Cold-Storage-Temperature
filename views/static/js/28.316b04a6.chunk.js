(this.webpackJsonpwarehouse=this.webpackJsonpwarehouse||[]).push([[28],{306:function(e,a,t){"use strict";var n=t(47),o=t(48),r=t(49),c=t(50),i=t(2),s=t.n(i),m=t(51),d=t(24),l=t(40),u=t(139),b=t.n(u),p=t(307),f=t.n(p),g=t(29),v=function e(a){var t=a.item,n=a.linkClassNames,o=a.subMenuClassNames,r=a.activatedMenuItemIds,c=t.icon||null;return s.a.createElement("li",{className:b()("side-nav-item",{"active mm-active":r.indexOf(t.id)>=0})},s.a.createElement(m.b,{to:"/",className:b()("side-sub-nav-link",n),"aria-expanded":r.indexOf(t.id)>=0},t.icon&&s.a.createElement(c,null),t.badge&&s.a.createElement("span",{className:"badge badge-".concat(t.badge.variant," float-right")},t.badge.text),s.a.createElement("span",null," ",t.name," "),s.a.createElement("span",{className:"menu-arrow"})),s.a.createElement("ul",{className:b()(o,{"mm-collapse mm-show":r.indexOf(t.id)>=0}),"aria-expanded":r.indexOf(t.id)>=0},t.children.map((function(a,t){return s.a.createElement(s.a.Fragment,{key:t},a.children?s.a.createElement(e,{item:a,linkClassNames:b()({active:r.indexOf(a.id)>=0}),activatedMenuItemIds:r,subMenuClassNames:"side-nav-third-level"}):s.a.createElement(h,{item:a,className:b()({active:r.indexOf(a.id)>=0}),linkClassName:b()({active:r.indexOf(a.id)>=0})}))}))))},h=function(e){var a=e.item,t=e.className,n=e.linkClassName;return s.a.createElement("li",{className:b()("side-nav-item",t)},s.a.createElement(E,{item:a,className:n}))},E=function(e){var a=e.item,t=e.className,n=a.icon||null;return s.a.createElement(m.b,{to:a.path,className:b()("side-nav-link-ref","side-sub-nav-link",t)},a.icon&&s.a.createElement(n,null),a.badge&&s.a.createElement("span",{className:"font-size-12 badge badge-".concat(a.badge.variant," float-right")},a.badge.text),s.a.createElement("span",null," ",a.name," "))},O=function(e){Object(r.a)(t,e);var a=Object(c.a)(t);function t(){var e;Object(n.a)(this,t);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return(e=a.call.apply(a,[this].concat(r))).componentDidMount=function(){e.props.menu.menuItems?e.initMenu():e.props.initMenu(),e.props.history.listen((function(a,t){e.props.changeActiveMenuFromLocation()}))},e.componentDidUpdate=function(a){(!a.menu.menuItems||a.menu.menuItems&&a.menu.menuItems!==e.props.menu.menuItems)&&e.initMenu(),e.props.menu.activatedMenuItemIds||e.props.changeActiveMenuFromLocation()},e}return Object(o.a)(t,[{key:"initMenu",value:function(){if("horizontal"===this.props.mode)var e=new f.a("#menu-bar").on("shown.metisMenu",(function(a){window.addEventListener("click",(function t(n){a.target.contains(n.target)||(e.hide(a.detail.shownElement),window.removeEventListener("click",t))}))}));else new f.a("#menu-bar")}},{key:"render",value:function(){var e=this,a="horizontal"===this.props.mode,t=a?[]:this.props.menu?this.props.menu.activatedMenuItemIds?this.props.menu.activatedMenuItemIds:[]:[]||!1;return s.a.createElement(s.a.Fragment,null,this.props.menu&&this.props.menu.menuItems&&s.a.createElement("ul",{className:"metismenu",id:"menu-bar"},this.props.menu.menuItems.map((function(n,o){if(e.props.RoomList.currentRoom&&n.roles.includes(e.props.RoomList.currentRoom.role))return s.a.createElement(s.a.Fragment,{key:n.id},n.header&&!a&&s.a.createElement("li",{className:"menu-title",key:o+"-el"},n.header),n.children?s.a.createElement(v,{item:n,subMenuClassNames:"nav-second-level",activatedMenuItemIds:t,linkClassNames:"side-nav-link"}):s.a.createElement(h,{item:n,className:b()({"mm-active":t.indexOf(n.id)>=0}),linkClassName:"side-nav-link"}))}))))}}]),t}(i.Component);O.defaultProps={mode:"vertical"};a.a=Object(d.g)(Object(l.b)((function(e){return{menu:e.AppMenu,RoomList:e.RoomList}}),{initMenu:g.jb,changeActiveMenuFromLocation:g.k})(O))},308:function(e,a){a.showNotification=function(e,a){new Notification(e,{body:a,icon:"http://vikhan.tk/assets/img/logo1.png",dir:"ltr",timestamp:3e3})}},594:function(e,a,t){"use strict";t.r(a);var n=t(47),o=t(48),r=t(66),c=t(49),i=t(50),s=t(2),m=t.n(s),d=t(51),l=t(40),u=t(595),b=t(239),p=t.n(b),f=(t(173),t(282)),g=t(403),v=t(344),h=t(343),E=t(295),O=t(235),_=t(288),k=t(627),j=t(306),N=t(29),y=t(308),C=t(70),w=t(89).BASE_URL,A=t(597),R=function(e){var a=Object(l.c)(),t=Object(C.useToasts)().addToast,n=m.a.useRef(null);m.a.useEffect((function(){return e.user&&e.user.accessToken?(a(Object(N.Y)(e.user)),a(Object(N.X)(e.user))):(console.log("Disconnect"),n.current&&n.current.disconnect(),n.current=null),function(){console.log("Disconnect"),n.current&&n.current.disconnect(),n.current=null}}),[e.user]);var o=function(t,n){e.currentRoom_id===t&&a(n)},r=function(t,n,o){e.currentRoom_id===t&&n!=e.user.user._id&&a(o)};return m.a.useEffect((function(){if(e.user.accessToken&&e.currentRoom_id){n.current&&n.current.disconnect(),n.current=A.connect(w),console.log("Connect");var c=n.current;console.log("Socket io Client run socket client with room: ",e.currentRoom_id),c.on("connect",(function(){console.log("Socket io Client  Connected"),c.emit("login",e.user.accessToken)})),c.on("data_cube_room",(function(e){o(e.room,Object(N.R)(e)),console.log("Socket io Client Cube",e)})),c.on("data_sensor",(function(e){o(e.room,Object(N.db)(e)),console.log("Socket io Client Sensor",e)})),c.on("data_room",(function(e){o(e.room,Object(N.U)(e)),console.log("Socket io Client Curent Data",e)})),c.on("log",(function(e){console.log("Socket io Client Log",e)})),c.on("data_area",(function(e){o(e.room,Object(N.L)(e)),console.log("Socket io Client Area",e)})),c.on("notification",(function(e){"add"==e.message&&(a(Object(N.ob)(e.data)),"granted"==Notification.permission?Object(y.showNotification)("Qu\u1ea3n l\xfd nhi\u1ec7t \u0111\u1ed9 kho l\u1ea1nh",e.data.content):t(e.data.content,{appearance:"warning",autoDismiss:!0})),"update"==e.message&&a(Object(N.Bb)(e.data._id,e.data))})),c.on("access",(function(t){console.log(t),"accepted"==t.message&&r(t.data.room._id,t.data.actionBy,Object(N.wb)(t.data.access)),"invite"==t.message&&r(t.data.room._id,t.data.actionBy,Object(N.b)(t.data.access)),"add"==t.message&&e.user&&t.data.access.user&&t.data.access.user._id===e.user.user._id&&(c.emit("join-room","room"+t.data.room._id),a(Object(N.Y)(e.user))),"edit"==t.message&&(e.user&&t.data.access.user&&t.data.access.user._id!==e.user.user._id?r(t.data.room._id,t.data.actionBy,Object(N.wb)(t.data.access)):a(Object(N.Y)(e.user))),"delete"==t.message&&(e.user&&t.data.access.user&&t.data.access.user._id!==e.user.user._id?r(t.data.room._id,t.data.actionBy,Object(N.r)(t.data.access._id)):(c.emit("leave-room","room"+t.data.room._id),a(Object(N.Y)(e.user)))),console.log("Socket io Client Access ",t)})),c.on("area",(function(a){"add"==a.message&&r(a.data.room._id,a.data.actionBy,Object(N.f)(a.data.area)),"edit"==a.message&&e.currentArea&&e.currentArea._id===a.data.area._id&&r(a.data.room._id,a.data.actionBy,Object(N.yb)(a.data.area)),"delete"==a.message&&r(a.data.room._id,a.data.actionBy,Object(N.w)(a.data.area._id)),"add-monitor"==a.message&&e.currentArea&&e.currentArea._id===a.data.area._id&&r(a.data.room._id,a.data.actionBy,Object(N.h)(a.data.monitors)),"edit-monitor"==a.message&&e.currentArea&&e.currentArea._id===a.data.area._id&&r(a.data.room._id,a.data.actionBy,Object(N.Ab)(a.data.monitor)),"switch-monitor"==a.message&&e.currentArea&&e.currentArea._id===a.data.area._id&&r(a.data.room._id,a.data.actionBy,Object(N.Ab)(a.data.monitor)),"delete-monitor"==a.message&&e.currentArea&&e.currentArea._id===a.data.area._id&&r(a.data.room._id,a.data.actionBy,Object(N.y)(a.data.monitors)),console.log("Socket io Client Area Info",a)})),c.on("activate",(function(e){"add"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.d)(e.data.activate)),"delete"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.t)(e.data.activate._id)),console.log("Socket io Client Activate ",e)})),c.on("room",(function(e){"edit"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.Db)(e.data.room)),"delete"==e.message&&(c.emit("leave-room","room"+e.data.room._id),r(e.data.room._id,e.data.actionBy,Object(N.B)(e.data.room._id))),console.log("Socket io Room Info ",e)})),c.on("structure",(function(e){"add"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.j)(e.data.structure)),"update"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.Fb)(e.data.structure)),"delete"==e.message&&r(e.data.room._id,e.data.actionBy,Object(N.D)(e.data.structure)),console.log("Socket io Client Structure ",e)})),c.on("disconnect",(function(){}))}return function(){n.current&&n.current.disconnect()}}),[e.user.accessToken,e.currentRoom_id,e.currentArea]),m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"media user-profile mt-2 mb-2"},m.a.createElement("img",{src:e.user.user.avatar,className:"avatar-sm rounded-circle mr-2",alt:e.user.user.username}),m.a.createElement("img",{src:e.user.user.avatar,className:"avatar-xs rounded-circle mr-2",alt:e.user.user.username}),m.a.createElement("div",{className:"media-body"},m.a.createElement("h6",{className:"pro-user-name mt-0 mb-0"},e.user.user.fullname),m.a.createElement("span",{className:"pro-user-desc"},e.user.user.username)),m.a.createElement(f.a,{className:"align-self-center profile-dropdown-menu"},m.a.createElement(g.a,{"data-toggle":"dropdown",tag:"button",className:"btn btn-link p-0 dropdown-toggle mr-0"},m.a.createElement(E.a,null)),m.a.createElement(v.a,{right:!0,className:"topbar-dropdown-menu profile-dropdown-items"},m.a.createElement(d.b,{to:"/account/info",className:"dropdown-item notify-item"},m.a.createElement(O.a,{className:"icon-dual icon-xs mr-2"}),m.a.createElement("span",null,"T\xe0i kho\u1ea3n")),m.a.createElement(d.b,{to:"/account/lock",className:"dropdown-item notify-item"},m.a.createElement(_.a,{className:"icon-dual icon-xs mr-2"}),m.a.createElement("span",null,"Kh\xf3a m\xe0n h\xecnh")),m.a.createElement(h.a,{divider:!0}),m.a.createElement(d.b,{to:"/account/logout",className:"dropdown-item notify-item"},m.a.createElement(k.a,{className:"icon-dual icon-xs mr-2"}),m.a.createElement("span",null,"\u0110\u0103ng xu\u1ea5t"))))))},M=function(){return m.a.createElement("div",{className:"sidebar-content"},m.a.createElement("div",{id:"sidebar-menu"},m.a.createElement(j.a,null)))},B=function(e){Object(c.a)(t,e);var a=Object(i.a)(t);function t(e){var o;return Object(n.a)(this,t),(o=a.call(this,e)).componentDidMount=function(){document.addEventListener("mousedown",o.handleOtherClick,!1)},o.componentWillUnmount=function(){document.removeEventListener("mousedown",o.handleOtherClick,!1)},o.handleOtherClick=function(e){o.menuNodeRef.contains(e.target)||document.body&&u.isMobileOnly&&document.body.classList.remove("sidebar-enable")},o.handleClick=o.handleClick.bind(Object(r.a)(o)),o.handleOtherClick=o.handleOtherClick.bind(Object(r.a)(o)),o}return Object(o.a)(t,[{key:"handleClick",value:function(e){console.log(e)}},{key:"render",value:function(){var e=this,a=this.props.isCondensed||!1;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"left-side-menu",ref:function(a){return e.menuNodeRef=a}},m.a.createElement(R,this.props),!a&&m.a.createElement(p.a,null,m.a.createElement(M,null)),a&&m.a.createElement(M,null)))}}]),t}(s.Component);a.default=Object(l.b)((function(e){var a=e.Auth,t=a.user,n=a.loading,o=a.error,r=e.RoomArea.currentArea;return{user:t,loading:n,error:o,currentRoom_id:e.RoomList.currentRoom?e.RoomList.currentRoom.room._id:null,currentArea:r}}),{})(B)}}]);
//# sourceMappingURL=28.316b04a6.chunk.js.map